pipeline {
    agent any
   
    stages {

      stage('clean')
            {
                steps
                 { 
                    sh 'mvn clean package'
                 }
            }
        stage("nexus") {
            steps {
            
            nexusArtifactUploader artifacts: [[artifactId: 'spring-boot-starter-parent', classifier: '', file: '/var/lib/jenkins/workspace/DeployPipeline/target/auth-1.3.5.RELEASE.war', type: 'war']], credentialsId: '1ede2bf7-9c27-4f53-8c00-e2b29e170a0e', groupId: 'org.springframework.boot', nexusUrl: '18.224.155.110:8081/nexus', nexusVersion: 'nexus2', protocol: 'http', repository: 'devopstraining', version: '1.3.5.RELEASE'
                
            } 
        }
        
        stage('deploy'){
        steps{  
          sshagent(['tomcat-dev']) {
            sh 'scp -o StrictHostKeyChecking=no target/*.war ec2-user@13.233.106.218:~/apache-tomcat-9.0.26/webapps/'
            }
        }
        }
        }
        }
